事件循环 Event Loop
处理任务队列 Task Queue
1、宏队列
2、微队列

在主线程空闲时执行任务 ， 先执行微队列中的任务， 再执行宏队列中的任务
实现非阻塞与响应性

为什么需要事件循环？
1、JavaScript  是单线程的
    单线程会造成 堵塞
    导致用户界面冻结，响应性下降
2、保证用户界面响应性
    DOM更新
    事件监听
3、支持异步编程模型
    Promise/async/await
    setTimeout/setInterval /fetch 

工作原理

    核心组成：
        调用栈
        堆
        任务队列
        事件循环本身
任务分类：
    宏任务:
        setTimeout/setInterval
        Dom事件
        I/O操作
        UI渲染(绘制)
        setImmediate(Node.js)
    微任务:
        Promise.then/.catch/.finally
        queueMicrotask  将一个微任务添加到微任务队列中
        MutationObserver回调  当DOM发生变化时触发
        process.nextTick(Node.js)   比微任务先执行

事件循环的单轮流程
    1、执行同步任务， 直到调用栈为空
    2、检查微任务队列是否为空
        2.1 如果为空， 则执行宏任务队列中的第一个任务
        2.2 如果不为空， 则依次执行微任务队列中的任务， 直到为空
    3、重复以上流程


关键注意事项
    同步代码永远优先
    微任务  优先于  宏任务
    Node.js 环境存在差异
    宏任务之间会有微任务清空及潜在的污染


